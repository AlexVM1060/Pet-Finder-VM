-- üêæ Pet ESP Finder con Toggle
-- by AlexVM adaptado y corregido

-- Servicios
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

local LocalPlayer = Players.LocalPlayer

-- Lista de mascotas objetivo
local targetPets = {
    ["Tralalero Tralala"] = true,
    ["La Vacca Saturno Saturnita"] = true,
    ["Chimpanzini Spiderini"] = true,
    ["Los Tralaleritos"] = true,
    ["Graipuss Medussi"] = true,
    ["La Grande Combinasion"] = true,
    ["Garama and Madundung"] = true,
    ["Orcalero Orcala"] = true,
    ["Torrtuginni Dragonfrutini"] = true,
    ["Pot Hotspot"] = true,
    ["Las Tralaleritas"] = true,
    ["Lucky Block"] = true,
    ["Nuclearo Dinossauro"] = true,
    ["Las Vaquitas Saturnitas"] = true,
    ["Los Tungtungtungcitos"] = true,
    ["Chicleteira Bicicleteira"] = true,
    ["Dragon Cannelloni"] = true,
    ["Los Hotspotsitos"] = true,
    ["Agarrini la Palini"] = true,
    ["Tob Tobi Tobi"] = true,
    ["Los Orcalitos"] = true,
    ["Karkerkar Kurkur"] = true,
    ["Bulbito Bandito Traktorito"] = true,
    ["Esok Sekolah"] = true,
    ["Tracoducotulu Delapeladustuz"] = true,
    ["Tralalita tralala"] = true,
    ["Job Job Job Sahur"] = true,
    ["Tipi Topi Taco"] = true,
    ["Urubini Flamenguini"] = true,
    ["Matteo"] = true,
    ["Los Matteos"] = true,
	["Blackhole Goat"] = true,
	["Tartaruga Cisterna"] = true,
	["Dul Dul Dul"] = true,
	["Los Bombinitos"] = true,
	["Bisonte Giuppitere"] = true,
	["Alessio"] = true,
	["Ballerino Lololo"] = true,
	["Trenostruzzo Turbo 3000"] = true,
	["Sammyni Spyderini"] = true,
	["Brr es Teh Patipum"] = true,
	["Piccione Macchina"] = true,
	["Los Combinasionas"] = true,
	["La Grande Combinasion"] = true
}

-- Variables globales
local espEnabled = false
local ScreenGui -- ser√° reconstruido cada respawn

-- Funci√≥n para obtener mutaci√≥n y generaci√≥n de pets
local function getMutationMap()
    local mutationMap = {}
    local plots = Workspace:FindFirstChild("Plots")
    if not plots then return mutationMap end

    for _, plot in ipairs(plots:GetChildren()) do
        local podiums = plot:FindFirstChild("AnimalPodiums")
        if podiums then
            for _, podium in ipairs(podiums:GetChildren()) do
                local base = podium:FindFirstChild("Base")
                local spawn = base and base:FindFirstChild("Spawn")
                local attachment = spawn and spawn:FindFirstChild("Attachment")
                local overhead = attachment and attachment:FindFirstChild("AnimalOverhead")
                local displayName = overhead and overhead:FindFirstChild("DisplayName")
                local mutation = overhead and overhead:FindFirstChild("Mutation")
                local generation = overhead and overhead:FindFirstChild("Generation")

                if spawn and displayName and displayName:IsA("TextLabel") then
                    local name = displayName.Text
                    local mutationText = (mutation and mutation:IsA("TextLabel") and mutation.Visible and mutation.Text ~= "" and mutation.Text ~= "Normal") and mutation.Text or "Normal"
                    local generationText = (generation and generation:IsA("TextLabel")) and generation.Text or "Unknown"

                    table.insert(mutationMap, {
                        name = name,
                        position = spawn.Position,
                        mutation = mutationText,
                        generation = generationText
                    })
                end
            end
        end
    end
    return mutationMap
end

-- Funci√≥n para crear ESP con mutaci√≥n y generaci√≥n
-- Funci√≥n para crear ESP con mutaci√≥n y generaci√≥n
-- Funci√≥n para crear ESP con mutaci√≥n y generaci√≥n
local function createESP(pet)
    if pet:FindFirstChild("ESP_Tag") then return end
    local head = pet:FindFirstChild("Head") or pet:FindFirstChildWhichIsA("BasePart")
    if not head then return end

    local mutationText, generationText = "Stolen", "Stolen"
    local mutationMap = getMutationMap()
    for _, data in ipairs(mutationMap) do
        if data.name == pet.Name then
            mutationText = data.mutation or "Normal"
            generationText = data.generation or "Stolen"
            break
        end
    end

    -- convertir el texto de generaci√≥n a n√∫mero (soporta K y M)
    local function parseGen(genStr)
        if not genStr or genStr == "Stolen" or genStr == "Unknown" then return 0 end
        local num = tonumber(genStr:match("%d+"))
        if not num then return 0 end
        if genStr:find("M") then
            return num * 1_000_000
        elseif genStr:find("K") then
            return num * 1_000
        else
            return num
        end
    end

    local genValue = parseGen(generationText)

    -- asignar color seg√∫n rango
    local genColor = Color3.fromRGB(255,0,0) -- por defecto rojo
    if genValue >= 1_000_000 then
        genColor = Color3.fromRGB(0,255,0) -- verde fuerte
    elseif genValue >= 500_000 then
        genColor = Color3.fromRGB(0,200,0) -- verde medio
    elseif genValue >= 50_000 then
        genColor = Color3.fromRGB(255,165,0) -- naranja/amarillo
    end

    local bill = Instance.new("BillboardGui")
    bill.Name = "ESP_Tag"
    bill.Size = UDim2.new(0, 200, 0, 60)
    bill.StudsOffset = Vector3.new(0, 3, 0)
    bill.AlwaysOnTop = true
    bill.Parent = pet

    -- üêæ Nombre
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, 0, 0.33, 0)
    nameLabel.Position = UDim2.new(0,0,0,0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = "üêæ ".. pet.Name
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 0) -- Amarillo
    nameLabel.TextStrokeTransparency = 0
    nameLabel.Font = Enum.Font.SourceSansBold
    nameLabel.TextScaled = true
    nameLabel.TextWrapped = true
    nameLabel.Parent = bill

    -- üß¨ Mutaci√≥n
    local mutationLabel = Instance.new("TextLabel")
    mutationLabel.Size = UDim2.new(1, 0, 0.33, 0)
    mutationLabel.Position = UDim2.new(0,0,0.33,0)
    mutationLabel.BackgroundTransparency = 1
    mutationLabel.Text = "üß¨: " .. mutationText
    mutationLabel.TextColor3 = Color3.fromRGB(0, 255, 255) -- Cyan
    mutationLabel.TextStrokeTransparency = 0
    mutationLabel.Font = Enum.Font.SourceSansBold
    mutationLabel.TextScaled = true
    mutationLabel.TextWrapped = true
    mutationLabel.Parent = bill

    -- üí∞ Dinero con color din√°mico
    local genLabel = Instance.new("TextLabel")
    genLabel.Size = UDim2.new(1, 0, 0.33, 0)
    genLabel.Position = UDim2.new(0,0,0.66,0)
    genLabel.BackgroundTransparency = 1
    genLabel.Text = "üí∞: " .. generationText
    genLabel.TextColor3 = genColor
    genLabel.TextStrokeTransparency = 0
    genLabel.Font = Enum.Font.SourceSansBold
    genLabel.TextScaled = true
    genLabel.TextWrapped = true
    genLabel.Parent = bill

    -- L√≠nea (beam) hacia el jugador
    local att0 = Instance.new("Attachment", head)
    local att1 = Instance.new("Attachment", LocalPlayer.Character:WaitForChild("HumanoidRootPart"))
    local beam = Instance.new("Beam")
    beam.Color = ColorSequence.new(Color3.fromRGB(255, 255, 0))
    beam.Width0 = 0.2
    beam.Width1 = 0.2
    beam.Attachment0 = att0
    beam.Attachment1 = att1
    beam.Parent = head
end


-- Funci√≥n para construir la UI
local function buildUI()
    if ScreenGui then ScreenGui:Destroy() end
    ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

    local espToggle = Instance.new("TextButton", ScreenGui)
    espToggle.Name = "ESP_Toggle"
    espToggle.Size = UDim2.new(0,120,0,30)
    espToggle.Position = UDim2.new(1,-130,0,50)
    espToggle.BackgroundColor3 = espEnabled and Color3.fromRGB(0,150,0) or Color3.fromRGB(50,50,50)
    espToggle.Text = espEnabled and "ESP: ON" or "ESP: OFF"
    espToggle.TextColor3 = Color3.fromRGB(255,255,255)
    espToggle.Font = Enum.Font.GothamBold
    espToggle.TextSize = 14
    Instance.new("UICorner", espToggle).CornerRadius = UDim.new(0,8)

    espToggle.MouseButton1Click:Connect(function()
        espEnabled = not espEnabled
        if espEnabled then
            espToggle.Text = "ESP: ON"
            espToggle.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
        else
            espToggle.Text = "ESP: OFF"
            espToggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            for _, obj in ipairs(workspace:GetDescendants()) do
                if obj:IsA("Model") and obj:FindFirstChild("ESP_Tag") then
                    obj.ESP_Tag:Destroy()
                end
            end
        end
    end)
end

-- Reconstruir UI cada vez que el jugador reaparezca
LocalPlayer.CharacterAdded:Connect(function()
    task.wait(1) -- espera que cargue PlayerGui
    buildUI()
end)

local function showCenterMessage()
    local msg = Instance.new("TextLabel")
    msg.Size = UDim2.new(0.8, 0, 0.15, 0) -- ancho 80% de la pantalla, alto 15%
    msg.Position = UDim2.new(0.1, 0, 0.4, 0) -- centrado horizontal y vertical
    msg.BackgroundTransparency = 1 -- sin fondo
    msg.Text = "‚ö† Lo siento si no pueden entrar a todos los servers porque est√°n llenos, recuerden que es gratuito, pero ya estoy tratando de arreglarlo, trabajar√© esta noche para solucionarlo, para que sea algo que puedan usar la mayor√≠a. No puedo hacer mucho porque es algo que muchos est√°n usando y solo los m√°s r√°pidos entran, pero tratar√© de cambiar unas cosas para que haya m√°s chance de entrar. Disculpen las molestias, muchas gracias por el apoyo, los quiero mucho ‚ù§"
    msg.TextColor3 = Color3.fromRGB(180,180,180) -- gris claro
    msg.TextWrapped = true
    msg.Font = Enum.Font.GothamSemibold
    msg.TextScaled = true
    msg.Parent = ScreenGui

    -- ‚è≥ Eliminar mensaje despu√©s de 10 segundos
    task.delay(10, function()
        if msg then
            msg:Destroy()
        end
    end)
end

-- Mostrar mensaje al ejecutar el script
showCenterMessage()

-- Crear la UI inicial
buildUI()

-- Escaneo de pets
RunService.Heartbeat:Connect(function()
    if not espEnabled then return end
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("Model") and targetPets[obj.Name] then
            createESP(obj)
        end
    end
end)
